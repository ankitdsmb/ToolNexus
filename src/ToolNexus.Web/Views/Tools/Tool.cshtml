@model ToolPageViewModel
@{ 
    ViewData["Title"] = Model.Seo.Title;
    ViewData["Description"] = Model.Seo.Description;
    ViewData["CanonicalUrl"] = Model.Seo.CanonicalUrl;
    ViewData["JsonLd"] = Model.Seo.JsonLd;
    ViewData["Keywords"] = Model.Seo.Keywords;
}

@if (string.Equals(Model.Tool.Slug, "js-minifier", StringComparison.OrdinalIgnoreCase))
{
    <link rel="stylesheet" href="~/css/pages/js-minifier.css" asp-append-version="true" />
}

@if (string.Equals(Model.Tool.Slug, "xml-to-json", StringComparison.OrdinalIgnoreCase))
{
    <link rel="stylesheet" href="~/css/pages/xml-to-json.css" asp-append-version="true" />
}

@if (string.Equals(Model.Tool.Slug, "xml-formatter", StringComparison.OrdinalIgnoreCase))
{
    <link rel="stylesheet" href="~/css/pages/xml-formatter.css" asp-append-version="true" />
}

<article class="tool-page tn-tool-shell" data-slug="@Model.Tool.Slug" data-client-safe-actions="@string.Join(",", Model.Tool.ClientSafeActions)">
  <header class="tool-page__heading tn-tool-header">
    <div>
      <h1>@Model.Tool.Title</h1>
      <p>@Model.Tool.SeoDescription</p>
    </div>
  </header>

  <section class="tool-layout tool-layout--elite tn-tool-body" aria-label="Tool workspace">
    <section class="tool-layout__panel tool-panel tn-tool-panel" aria-labelledby="toolInputHeading">
      <div class="panel-header">
        <h2 id="toolInputHeading">Input</h2>
      </div>

      <div class="tool-page__action-selector">
        <label for="actionSelect">Action</label>
        <select id="actionSelect">
          @foreach (var action in Model.Tool.Actions)
          {
            <option value="@action">@action</option>
          }
        </select>
      </div>

      <div class="tool-toolbar__actions" role="toolbar" aria-label="Run and output actions">
        <button id="runBtn" class="tool-btn tool-btn--primary" type="button" aria-busy="false">
          <span class="spinner" aria-hidden="true"></span>
          <span class="tool-btn__label" data-loading-label="Running…" data-default-label="Run">Run</span>
        </button>
        <button id="copyBtn" class="tool-btn tool-btn--outline" type="button">Copy</button>
        <button id="downloadBtn" class="tool-btn tool-btn--ghost" type="button">Download</button>
        <button id="shareBtn" class="tool-btn tool-btn--ghost" type="button">Share</button>
      </div>

      <p class="shortcut-hint" id="editorShortcutHint">Shortcut: Ctrl/Cmd + Enter to run</p>

      <div class="sample-panel">
        <h3>Sample Data</h3>
        <pre id="sampleInput">@Model.Tool.ExampleInput</pre>
      </div>

      <div class="editor-field">
        <label for="inputEditor" class="editor-label">Tool input</label>
        <textarea id="inputEditor" aria-describedby="editorShortcutHint">@Model.Tool.ExampleInput</textarea>
        <div id="inputEditorSurface" class="editor-surface" aria-hidden="true"></div>
      </div>
    </section>

    <section class="tool-layout__panel tool-panel tool-panel--output tn-tool-panel" aria-labelledby="toolOutputHeading">
      <div class="panel-header">
        <h2 id="toolOutputHeading">Output</h2>
      </div>

      <div id="runtimeStatusBand" class="tool-runtime-status-band" role="status" aria-live="polite">
        <p id="resultStatus" class="result-indicator result-indicator--idle">Ready</p>
        <span id="detectedFormatBadge" class="tool-intel-badge" hidden>Detected: Plain text</span>
        <span id="confidenceBadge" class="tool-intel-badge tool-intel-badge--confidence" hidden>Confidence: Ready</span>
        <div id="suggestionChips" class="tool-suggestion-chips" aria-label="Suggested actions"></div>
      </div>

      <div id="contextHints" class="tool-context-hints" aria-live="polite"></div>

      <div id="errorMessage" class="tool-error" role="alert" aria-live="assertive" hidden></div>

      <div id="outputEmptyState" class="tool-empty-state" role="status" aria-live="polite">
        <span class="tool-empty-state__icon" aria-hidden="true">✦</span>
        <strong id="emptyStateTitle">No output yet.</strong>
        <span id="emptyStateHint">Run the selected action to render output in this panel.</span>
        <span id="emptyStateExample" class="shortcut-hint" hidden>Example: {"name":"ToolNexus","mode":"execute"}</span>
        <button id="quickRunBtn" class="tool-btn tool-btn--outline" type="button" hidden>Use example + Run</button>
        <span class="shortcut-hint">Tip: use Ctrl/Cmd + Enter for quick run.</span>
      </div>

      <div class="editor-field" id="outputField" hidden>
        <label for="outputEditor" class="editor-label">Tool output</label>
        <textarea id="outputEditor" readonly></textarea>
        <div id="outputEditorSurface" class="editor-surface" aria-hidden="true"></div>
      </div>
    </section>
  </section>

  <section class="tool-panel tool-ux" aria-labelledby="toolUxHeading">
    <div class="panel-header">
      <h2 id="toolUxHeading">Developer UX Layer</h2>
    </div>

    <div class="tool-ux__grid">
      <section>
        <h3>Pinned + Recent</h3>
        <ul id="uxPinnedRecent" class="ux-list"></ul>
      </section>
      <section>
        <h3>Run History</h3>
        <ul id="uxHistory" class="ux-list"></ul>
      </section>
      <section>
        <h3>Collections</h3>
        <div class="ux-collection-controls">
          <input id="collectionNameInput" type="text" placeholder="Collection name" maxlength="32" />
          <button id="saveCollectionBtn" class="tool-btn" type="button">Save Tool</button>
        </div>
        <ul id="uxCollections" class="ux-list"></ul>
      </section>
    </div>
  </section>

  <section class="tool-panel tool-workflow-intelligence" aria-labelledby="workflowIntelligenceHeading">
    <div class="panel-header">
      <h2 id="workflowIntelligenceHeading">Workflow Intelligence</h2>
      <p id="workflowCompletionSignal" class="result-indicator result-indicator--idle" role="status" aria-live="polite">Ready for the next step</p>
    </div>

    <div class="tool-workflow-intelligence__grid">
      <section>
        <h3>Related Tool Intelligence</h3>
        <ul id="workflowRelatedTools" class="ux-list"></ul>
      </section>
      <section>
        <h3>Workflow Pathways</h3>
        <div id="workflowPathways" class="workflow-pathways"></div>
      </section>
      <section>
        <h3>Smart Context Panel</h3>
        <p id="smartContextHint" class="tool-smart-context">Context hints load when you start typing.</p>
        <button id="workflowContinueBtn" class="tool-btn tool-btn--outline" type="button" hidden>Continue workflow</button>
      </section>
    </div>
  </section>

  <section id="toastRegion" class="toast-region" aria-live="polite" aria-atomic="true" aria-relevant="additions text"></section>

@if (Model.Content is not null)
{
  <section class="tool-panel">
    <h2>How It Works</h2>
    <p>@Model.Content.LongArticle</p>

    @if (Model.Content.Features.Any())
    {
      <h3>Features</h3>
      <ul>
      @foreach (var feature in Model.Content.Features)
      {
        <li>@feature</li>
      }
      </ul>
    }

    @if (Model.Content.Faqs.Any())
    {
      <h3>FAQ</h3>
      @foreach (var faq in Model.Content.Faqs)
      {
        <details>
          <summary>@faq.Question</summary>
          <p>@faq.Answer</p>
        </details>
      }
    }

    @if (Model.Content.RelatedTools.Any())
    {
      <h3>Related Tools</h3>
      <ul>
      @foreach (var related in Model.Content.RelatedTools)
      {
        <li><a href="/tools/@related.RelatedSlug">@related.RelatedSlug</a></li>
      }
      </ul>
    }
  </section>
}
</article>
