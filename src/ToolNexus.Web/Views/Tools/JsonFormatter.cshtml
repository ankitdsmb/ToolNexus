@model ToolPageViewModel
@{
    ViewData["Title"] = Model.Seo.Title;
    ViewData["Description"] = Model.Seo.Description;
    ViewData["CanonicalUrl"] = Model.Seo.CanonicalUrl;
    ViewData["JsonLd"] = Model.Seo.JsonLd;
    ViewData["Keywords"] = Model.Seo.Keywords;
}

@section Head {
    <link rel="stylesheet" href="~/css/pages/json-formatter.css" asp-append-version="true" />
}

<article class="json-formatter-page tool-page tool" data-slug="@Model.Tool.Slug" data-tool="json-formatter">
    <header class="json-formatter-header">
        <div>
            <h1>@Model.Tool.Title</h1>
            <p class="json-formatter-description">Validate, format, and minify JSON locally in your browser with deterministic output.</p>
        </div>
        <span class="json-processing-badge">Client-side processing</span>
    </header>

    <section class="json-toolbar" role="toolbar" aria-label="JSON formatter actions">
        <div class="json-toolbar-row">
            <button id="formatBtn" class="tool-btn tool-btn--primary" type="button">Format</button>
            <button id="minifyBtn" class="tool-btn" type="button">Minify</button>
            <button id="validateBtn" class="tool-btn" type="button">Validate only</button>
            <button id="clearBtn" class="tool-btn" type="button">Clear</button>
            <button id="copyBtn" class="tool-btn" type="button">Copy output</button>
            <button id="downloadBtn" class="tool-btn" type="button">Download JSON</button>
        </div>
        <div class="json-toolbar-row">
            <label class="tool-toggle" for="indentSizeSelect">Indentation
                <select id="indentSizeSelect" class="tool-select" aria-label="Indentation size">
                    <option value="2" selected>2 spaces</option>
                    <option value="4">4 spaces</option>
                </select>
            </label>
            <label class="tool-toggle"><input id="sortKeysToggle" type="checkbox" /> Sort object keys</label>
            <label class="tool-toggle"><input id="autoFormatToggle" type="checkbox" /> Auto format on input</label>
            <label class="tool-toggle"><input id="wrapToggle" type="checkbox" /> Word wrap</label>
        </div>
    </section>

    <section id="errorBox" class="tool-error" role="alert" aria-live="assertive" hidden>
        <h2 id="errorTitle" class="tool-error-title"></h2>
        <p id="errorDetail" class="tool-error-detail"></p>
        <p id="errorLocation" class="tool-error-location" hidden></p>
    </section>

    <section class="json-workspace">
        <section class="json-panel">
            <div class="panel-header">
                <h2>Input JSON</h2>
                <p>Ctrl+Enter to format · Ctrl+L to clear</p>
            </div>
            <div id="jsonEditor" class="editor-surface" aria-label="JSON input editor"></div>
        </section>

        <section class="json-panel">
            <div class="panel-header">
                <h2>Output JSON</h2>
                <p id="resultStatus">Ready for formatting.</p>
            </div>
            <div id="outputEditor" class="editor-surface" aria-label="JSON output editor"></div>
        </section>
    </section>

    <section class="json-metrics" aria-live="polite">
        <p><span>Validation</span><strong id="validationState">Awaiting input</strong></p>
        <p><span>Execution</span><strong id="perfTime">0 ms</strong></p>
        <p><span>Input size</span><strong id="payloadStats">0 chars / 0 lines</strong></p>
        <p><span>Output size</span><strong id="outputStats">0 chars / 0 lines</strong></p>
    </section>

    <section id="processingIndicator" class="tool-warning" hidden>Processing large JSON payload…</section>
    <section id="toastRegion" class="toast-region" aria-live="polite" aria-atomic="true"></section>
</article>

@section Scripts {
    <script>
        window.ToolNexusConfig = {
          jsonExampleInput: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.ExampleInput))
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.52.2/min/vs/loader.min.js" crossorigin="anonymous"></script>
    <script type="module" src="~/js/tools/json-formatter.js" asp-append-version="true"></script>
}
