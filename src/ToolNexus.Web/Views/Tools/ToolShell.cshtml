@model ToolPageViewModel
@{
    ViewData["Title"] = Model.Seo.Title;
    ViewData["Description"] = Model.Seo.Description;
    ViewData["CanonicalUrl"] = Model.Seo.CanonicalUrl;
    ViewData["JsonLd"] = Model.Seo.JsonLd;
    ViewData["Keywords"] = Model.Seo.Keywords;
}

@section Head {
    @if (!string.IsNullOrWhiteSpace(Model.RuntimeCssPath))
    {
        <link rel="stylesheet" href="@Model.RuntimeCssPath" asp-append-version="true" />
    }
}

<section class="tool-seo" data-nosnippet="false">
    <h1>@Model.Tool.Title</h1>
    <p>@Model.Tool.SeoDescription</p>

    @if (Model.Content is not null)
    {
        <section class="tool-seo__intro" aria-label="Tool overview">
            <h2>@Model.Content.Title</h2>
            <p>@Model.Content.ShortDescription</p>
            <div>@Model.Content.LongArticle</div>
        </section>

        @if (Model.Content.Features.Any())
        {
            <section class="tool-seo__features" aria-label="Key features">
                <h2>Features</h2>
                <ul>
                    @foreach (var feature in Model.Content.Features)
                    {
                        <li>@feature</li>
                    }
                </ul>
            </section>
        }

        @if (Model.Content.Faqs.Any())
        {
            <section class="tool-seo__faq" aria-label="Frequently asked questions">
                <h2>FAQ</h2>
                @foreach (var faq in Model.Content.Faqs)
                {
                    <article>
                        <h3>@faq.Question</h3>
                        <p>@faq.Answer</p>
                    </article>
                }
            </section>
        }


        @if (Model.RelatedTools.Any())
        {
            <section class="tool-seo__related" aria-label="Related tools">
                <h2>Related tools</h2>
                <ul>
                    @foreach (var relatedTool in Model.RelatedTools)
                    {
                        <li><a href="/tools/@relatedTool.Slug">@relatedTool.Title</a></li>
                    }
                </ul>
            </section>
        }
    }
</section>

<div id="tool-root" data-tool-slug="@Model.Tool.Slug">
    <section class="tool-runtime-fallback tn-tool-shell" data-ssr-fallback="true">
        <header class="tn-tool-header">
            <h2>@Model.Tool.Title</h2>
            <p>@Model.Tool.SeoDescription</p>
        </header>
        <div class="tn-tool-body">
            <section class="tn-tool-panel" aria-label="Input panel"></section>
            <section class="tn-tool-panel" aria-label="Output panel"></section>
        </div>
        <footer class="tn-tool-footer">Server-rendered fallback is active while runtime initializes.</footer>
    </section>
</div>

@section Scripts {
    <script>
        window.ToolNexusConfig = {
            apiBaseUrl: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.ApiBaseUrl)),
            toolExecutionPathPrefix: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.ToolExecutionPathPrefix)),
            runtimeModulePath: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.RuntimeModulePath)),
            tool: {
                slug: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.Slug)),
                title: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.Title)),
                seoDescription: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.SeoDescription)),
                exampleInput: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.ExampleInput)),
                clientSafeActions: @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.Tool.ClientSafeActions))
            }
        };
    </script>
    <script type="module" src="~/js/tool-runtime.js" asp-append-version="true"></script>
}
