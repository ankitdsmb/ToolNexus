@using System.Text.Json
@using ToolNexus.Web.Models.Layout
@using ToolNexus.Web.Services
@inject IAppVersionService AppVersion
@{
    var title = ViewData["Title"]?.ToString() ?? "ToolNexus";
    var description = ViewData["Description"]?.ToString() ?? "ToolNexus online developer tools.";
    var canonicalUrl = ViewData["CanonicalUrl"]?.ToString()
        ?? $"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.Path}{Context.Request.QueryString}";
    var keywords = ViewData["Keywords"]?.ToString() ?? "developer tools, online utilities, ToolNexus";
    var robots = ViewData["Robots"]?.ToString() ?? "index,follow";
    var jsonLd = ViewData["JsonLd"]?.ToString();
    var siteUrl = $"{Context.Request.Scheme}://{Context.Request.Host}";
    var socialImageUrl = ViewData["SocialImageUrl"]?.ToString() ?? $"{siteUrl}/assets/toolnexus-og.svg";
    var footerModel = new LayoutFooterViewModel
    {
        VersionDisplay = AppVersion.VersionDisplay,
        BuildNumber = AppVersion.BuildNumber
    };

    var defaultJsonLd = JsonSerializer.Serialize(new
    {
        @context = "https://schema.org",
        @graph = new object[]
        {
            new
            {
                @type = "Organization",
                name = "ToolNexus",
                url = siteUrl,
                logo = $"{siteUrl}/assets/toolnexus-og.svg"
            },
            new
            {
                @type = "WebSite",
                name = "ToolNexus",
                url = siteUrl,
                description = "Developer-first utility platform for faster shipping."
            }
        }
    });
}
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@title</title>

    <meta name="description" content="@description" />
    <meta name="keywords" content="@keywords" />
    <meta name="robots" content="@robots" />
    <meta name="theme-color" content="#0b1020" />
    <link rel="canonical" href="@canonicalUrl" />
    <link rel="icon" type="image/svg+xml" href="~/assets/toolnexus-og.svg" />
    <link rel="shortcut icon" href="~/assets/toolnexus-og.svg" />

    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="ToolNexus" />
    <meta property="og:title" content="@title" />
    <meta property="og:description" content="@description" />
    <meta property="og:url" content="@canonicalUrl" />
    <meta property="og:image" content="@socialImageUrl" />
    <meta property="og:image:alt" content="ToolNexus developer utility platform" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:image" content="@socialImageUrl" />
    <meta name="twitter:title" content="@title" />
    <meta name="twitter:description" content="@description" />

    @if (!string.IsNullOrWhiteSpace(jsonLd))
    {
        <script type="application/ld+json">@Html.Raw(jsonLd)</script>
    }

    <script type="application/ld+json">@Html.Raw(defaultJsonLd)</script>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/home-system.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/product-transform.css" asp-append-version="true" />
    @await RenderSectionAsync("Head", required: false)
</head>
<body class="page-enter">
<div class="app-shell">
    <div class="shell-layer shell-layer--command">
        <partial name="_Header" />
    </div>

    <div class="shell-layer shell-layer--workspace">
        <main class="container" role="main">
            @RenderBody()
        </main>
    </div>

    <div class="shell-layer shell-layer--system">
        <partial name="_Footer" model="footerModel" />
    </div>
</div>

<script type="module" src="~/js/ui-state-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/theme-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/version-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/command-palette-loader.js" asp-append-version="true"></script>
<script type="module" src="~/js/header-state.js" asp-append-version="true"></script>
<script type="module">
    if (document.querySelector('[data-tool-group], .tools-index')) {
        import('/js/tools-grid.js');
    }

    const hasRuntimeShell = Boolean(document.querySelector('#tool-root[data-tool-root="true"]'));
    if (document.querySelector('.tool-page') && !hasRuntimeShell) {
        import('/js/tool-page.js');
    }

    if (document.querySelector('[data-reveal], [data-dynamic-stat]')) {
        import('/js/motion-system.js');
        import('/js/dynamic-widget-engine.js');
    }
</script>

@await RenderSectionAsync("Scripts", required: false)

</body>
</html>
