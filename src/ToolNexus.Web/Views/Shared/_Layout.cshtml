@using System.Text.Json
@using ToolNexus.Web.Models.Layout
@using ToolNexus.Web.Services
@inject IAppVersionService AppVersion
@{
    var title = ViewData["Title"]?.ToString() ?? "ToolNexus";
    var description = ViewData["Description"]?.ToString() ?? "ToolNexus online developer tools.";
    var canonicalUrl = ViewData["CanonicalUrl"]?.ToString()
        ?? $"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.Path}{Context.Request.QueryString}";
    var keywords = ViewData["Keywords"]?.ToString() ?? "developer tools, online utilities, ToolNexus";
    var robots = ViewData["Robots"]?.ToString() ?? "index,follow";
    var jsonLd = ViewData["JsonLd"]?.ToString();
    var siteUrl = $"{Context.Request.Scheme}://{Context.Request.Host}";
    var socialImageUrl = ViewData["SocialImageUrl"]?.ToString() ?? $"{siteUrl}/assets/toolnexus-og.svg";
    var currentPath = ViewContext.HttpContext.Request.Path.Value?.ToLowerInvariant() ?? string.Empty;

    bool IsActive(string path)
    {
        var normalizedPath = path.ToLowerInvariant();
        return normalizedPath == "/"
            ? string.Equals(currentPath, "/", StringComparison.Ordinal)
            : currentPath.StartsWith(normalizedPath, StringComparison.Ordinal);
    }

    var headerModel = new LayoutHeaderViewModel
    {
        Links =
        [
            new NavLinkViewModel { Text = "Home", Href = "/", IsActive = IsActive("/") },
            new NavLinkViewModel { Text = "Tools", Href = "/tools", IsActive = IsActive("/tools") },
            new NavLinkViewModel { Text = "About", Href = "/about", IsActive = IsActive("/about") },
            new NavLinkViewModel { Text = "Disclaimer", Href = "/disclaimer", IsActive = IsActive("/disclaimer") },
            new NavLinkViewModel { Text = "Contact Us", Href = "/contact-us", IsActive = IsActive("/contact-us") }
        ]
    };

    var footerModel = new LayoutFooterViewModel
    {
        VersionDisplay = AppVersion.VersionDisplay,
        BuildNumber = AppVersion.BuildNumber
    };

    var defaultJsonLd = JsonSerializer.Serialize(new
    {
        @context = "https://schema.org",
        @graph = new object[]
        {
            new
            {
                @type = "Organization",
                name = "ToolNexus",
                url = siteUrl,
                logo = $"{siteUrl}/assets/toolnexus-og.svg"
            },
            new
            {
                @type = "WebSite",
                name = "ToolNexus",
                url = siteUrl,
                description = "Developer-first utility platform for faster shipping."
            }
        }
    });
}
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@title</title>

    <meta name="description" content="@description" />
    <meta name="keywords" content="@keywords" />
    <meta name="robots" content="@robots" />
    <meta name="theme-color" content="#0b1020" />
    <link rel="canonical" href="@canonicalUrl" />

    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="ToolNexus" />
    <meta property="og:title" content="@title" />
    <meta property="og:description" content="@description" />
    <meta property="og:url" content="@canonicalUrl" />
    <meta property="og:image" content="@socialImageUrl" />
    <meta property="og:image:alt" content="ToolNexus developer utility platform" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:image" content="@socialImageUrl" />
    <meta name="twitter:title" content="@title" />
    <meta name="twitter:description" content="@description" />

    @if (!string.IsNullOrWhiteSpace(jsonLd))
    {
        <script type="application/ld+json">@Html.Raw(jsonLd)</script>
    }

    <script type="application/ld+json">@Html.Raw(defaultJsonLd)</script>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    @await RenderSectionAsync("Head", required: false)
</head>
<body class="page-enter">
<div class="app-shell">
    <partial name="_Header" model="headerModel" />

    <main class="container" role="main">
        @RenderBody()
    </main>

    <partial name="_Footer" model="footerModel" />
</div>

<div id="commandPaletteModal" class="command-palette" hidden>
    <button class="command-palette__backdrop" type="button" data-command-close aria-label="Close command palette"></button>
    <section class="command-palette__dialog" role="dialog" aria-modal="true" aria-labelledby="commandPaletteTitle">
        <header class="command-palette__header">
            <h2 id="commandPaletteTitle" class="command-palette__title">Command palette</h2>
            <button class="command-palette__close" type="button" data-command-close aria-label="Close command palette">âœ•</button>
        </header>
        <label class="u-sr-only" for="commandPaletteInput">Search tools</label>
        <input id="commandPaletteInput" class="command-palette__input" type="text" placeholder="Search tools and actions..." autocomplete="off" />
        <ul id="commandPaletteList" class="command-palette__list" role="listbox"></ul>
    </section>
</div>

<script type="module" src="~/js/ui-state-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/theme-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/command-palette.js" asp-append-version="true"></script>
<script type="module" src="~/js/tools-grid.js" asp-append-version="true"></script>
<script type="module" src="~/js/dynamic-widget-engine.js" asp-append-version="true"></script>
<script type="module" src="~/js/tool-page.js" asp-append-version="true"></script>
<script type="module" src="~/js/version-manager.js" asp-append-version="true"></script>
<script type="module" src="~/js/motion-system.js" asp-append-version="true"></script>

@await RenderSectionAsync("Scripts", required: false)

</body>
</html>
