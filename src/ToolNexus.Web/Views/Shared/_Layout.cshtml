<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
@{
    var title = ViewData["Title"]?.ToString() ?? "ToolNexus";
    var description = ViewData["Description"]?.ToString() ?? "ToolNexus online developer tools.";
    var canonicalUrl = ViewData["CanonicalUrl"]?.ToString()
        ?? $"{Context.Request.Scheme}://{Context.Request.Host}{Context.Request.Path}{Context.Request.QueryString}";
    var keywords = ViewData["Keywords"]?.ToString() ?? "developer tools, online utilities, ToolNexus";
    var robots = ViewData["Robots"]?.ToString() ?? "index,follow";
    var jsonLd = ViewData["JsonLd"]?.ToString();
}

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>@title</title>

    <script>
        (function () {
            var key = 'toolnexus-theme';
            var stored = localStorage.getItem(key);
            var preferred = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            var theme = stored === 'light' || stored === 'dark' ? stored : preferred;
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>

    <meta name="description" content="@description" />
    <meta name="keywords" content="@keywords" />
    <meta name="robots" content="@robots" />
    <link rel="canonical" href="@canonicalUrl" />

    <meta property="og:type" content="website" />
    <meta property="og:title" content="@title" />
    <meta property="og:description" content="@description" />
    <meta property="og:url" content="@canonicalUrl" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="@title" />
    <meta name="twitter:description" content="@description" />

    @if (!string.IsNullOrWhiteSpace(jsonLd))
    {
        <script type="application/ld+json">
            @Html.Raw(jsonLd)
        </script>
    }

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css"
          crossorigin="anonymous" />
</head>

<body>
<div class="app-shell">
    <header class="topbar">
        <div class="topbar__inner">
            <a href="/" class="brand" aria-label="ToolNexus Home">
                <span class="brand__dot" aria-hidden="true"></span>
                <span>ToolNexus</span>
            </a>

            <div class="topbar__search-wrap">
                <label class="u-sr-only" for="globalToolSearch">Search tools</label>
                <input id="globalToolSearch"
                       class="topbar__search"
                       placeholder="Search tools..."
                       autocomplete="off" />
            </div>

            <nav class="topbar__nav" aria-label="Primary Navigation">
                <a class="topbar__link" href="/">Home</a>
                <a class="topbar__link" href="/tools">Tools</a>
                <a class="topbar__link" href="/about">About</a>
                <a class="topbar__link" href="/disclaimer">Disclaimer</a>
                <a class="topbar__link" href="/contact-us">Contact Us</a>
            </nav>

            <button id="themeToggle"
                    class="theme-toggle"
                    type="button"
                    aria-label="Activate dark theme"
                    aria-pressed="false">
                <span class="theme-toggle__icon" aria-hidden="true">◐</span>
                <span class="theme-toggle__text">Theme</span>
            </button>
        </div>
    </header>

    <div class="banner">
        Do not paste secrets or sensitive credentials.
    </div>

    <main class="container">
        @RenderBody()
    </main>

    <footer class="footer">
        <div class="footer__inner">
            <span>© @DateTime.UtcNow.Year ToolNexus. All rights reserved.</span>

            <nav class="footer-nav" aria-label="Footer Navigation">
                <a href="/">Home</a>
                <a href="/tools">Tools</a>
                <a href="/about">About</a>
                <a href="/disclaimer">Disclaimer</a>
                <a href="/contact-us">Contact Us</a>
            </nav>
        </div>
    </footer>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/javascript/javascript.min.js"></script>
<script>
    (function () {
        var key = 'toolnexus-theme';
        var root = document.documentElement;
        var toggle = document.getElementById('themeToggle');
        if (!toggle) return;

        function getTheme() {
            return root.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
        }

        function syncToggle(theme) {
            var dark = theme === 'dark';
            toggle.setAttribute('aria-pressed', dark ? 'true' : 'false');
            toggle.setAttribute('aria-label', dark ? 'Activate light theme' : 'Activate dark theme');
        }

        syncToggle(getTheme());

        toggle.addEventListener('click', function () {
            var next = getTheme() === 'dark' ? 'light' : 'dark';
            root.setAttribute('data-theme', next);
            localStorage.setItem(key, next);
            syncToggle(next);
            window.dispatchEvent(new CustomEvent('toolnexus:themechange', { detail: { theme: next } }));
        });

        var media = window.matchMedia('(prefers-color-scheme: dark)');
        media.addEventListener('change', function (event) {
            if (localStorage.getItem(key)) return;
            var next = event.matches ? 'dark' : 'light';
            root.setAttribute('data-theme', next);
            syncToggle(next);
            window.dispatchEvent(new CustomEvent('toolnexus:themechange', { detail: { theme: next } }));
        });
    })();
</script>

@await RenderSectionAsync("Scripts", required: false)

</body>
</html>
